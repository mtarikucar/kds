# YOLOv8 Training Configuration for Restaurant Person Detection

# Dataset configuration
dataset:
  # YOLO format dataset
  path: ../data
  train: labeled/train
  val: labeled/val
  test: labeled/test

  # Class names
  names:
    0: person

  # Number of classes
  nc: 1

# Training configuration
training:
  # Base model (yolov8n, yolov8s, yolov8m, yolov8l, yolov8x)
  model: yolov8n.pt

  # Training parameters
  epochs: 100
  batch: 16
  imgsz: 640
  patience: 20  # Early stopping patience

  # Learning rate
  lr0: 0.01
  lrf: 0.01
  momentum: 0.937
  weight_decay: 0.0005

  # Warmup
  warmup_epochs: 3.0
  warmup_momentum: 0.8
  warmup_bias_lr: 0.1

  # Data augmentation
  augmentation:
    hsv_h: 0.015  # Hue augmentation
    hsv_s: 0.7    # Saturation augmentation
    hsv_v: 0.4    # Value augmentation
    degrees: 0.0  # Rotation degrees
    translate: 0.1
    scale: 0.5
    shear: 0.0
    perspective: 0.0
    flipud: 0.0   # Vertical flip (not for person detection)
    fliplr: 0.5   # Horizontal flip
    mosaic: 1.0
    mixup: 0.0
    copy_paste: 0.0

  # Device configuration
  device: 'cpu'  # 'cpu', 'cuda', 'mps', or device ID (0, 1, etc.)
  workers: 8

  # Optimizer
  optimizer: 'auto'  # SGD, Adam, AdamW, NAdam, RAdam, RMSProp, auto

# Evaluation configuration
evaluation:
  conf: 0.25      # Confidence threshold for evaluation
  iou: 0.6        # IoU threshold for NMS
  max_det: 100    # Maximum detections per image

# Export configuration
export:
  formats:
    - onnx
    - torchscript
  simplify: true
  opset: 12
  dynamic: false

# Restaurant-specific optimizations
restaurant:
  # Focus on detection at typical restaurant distances
  min_person_height: 50   # Minimum person height in pixels
  max_person_height: 600  # Maximum person height in pixels

  # Crowded scene handling
  max_overlap: 0.5        # Maximum allowed overlap between detections

  # Lighting conditions
  handle_low_light: true
  handle_backlight: true
